# Web UI実装用チケット（優先度・見積もり・依存関係つき）

本ドキュメントは、以下3段階の成果物を実装に移すための実務チケット一覧です。

- ① Web UI要件定義（画面一覧・権限・操作フロー）
- ② MVP API設計（読み取り専用）
- ③ 実装タスク分割

---

## 0. 前提・方針

- **MVPは読み取り専用**で開始し、既存運用（YAMLベース）を壊さない。
- **一次情報はYAML**（`queue/`, `projects/`, `config/`）を参照し、`dashboard.md`は補助表示とする。
- スマホ利用を重視し、**モバイルファーストUI**で設計する。
- チケット見積もりは非エンジニア運用を想定した、実装＋軽量テスト込み。

### 見積もり単位

- **S**: 0.5〜1日
- **M**: 1〜2日
- **L**: 2〜4日

---

## 1. 優先度付きバックログ（実装チケット）

## P0（最優先）: 可視化MVPを最短で立ち上げる

### TKT-001: Webアプリ基盤作成（backend/frontend雛形）
- **優先度**: P0
- **見積もり**: M
- **依存関係**: なし
- **概要**:
  - `web/backend`（FastAPI）と `web/frontend`（Next.js等）を作成
  - ローカル起動手順を `web/README.md` に記載
- **完了条件（DoD）**:
  - `backend` と `frontend` がそれぞれ起動できる
  - ヘルスチェックAPIにアクセスできる

### TKT-002: YAMLリーダー層実装（読み取り専用）
- **優先度**: P0
- **見積もり**: M
- **依存関係**: TKT-001
- **概要**:
  - `queue/`, `projects/`, `config/` から安全に読み取る共通モジュールを実装
  - YAML破損時のフォールバック（エラー返却/ログ）実装
- **完了条件（DoD）**:
  - 主要ファイルがAPI層から読み取り可能
  - 破損YAML時に500ではなく定義済みエラー形式で返せる

### TKT-003: 共通データスキーマ定義（Command/Task/Report）
- **優先度**: P0
- **見積もり**: S
- **依存関係**: TKT-001
- **概要**:
  - Pydanticでレスポンスモデルを統一
  - status / timestamp / id のバリデーションルール定義
- **完了条件（DoD）**:
  - APIレスポンスが全て同一ラッパー形式（data/meta/error）
  - 型エラー時の応答が統一される

### TKT-004: ダッシュボード集約API（読み取り）
- **優先度**: P0
- **見積もり**: M
- **依存関係**: TKT-002, TKT-003
- **概要**:
  - `GET /api/v1/dashboard/summary`
  - 進行中件数・完了件数・要対応件数・最新更新時刻を返却
- **完了条件（DoD）**:
  - UIでKPIカード表示に必要なデータを1APIで取得可能

### TKT-005: コマンド一覧/詳細API（読み取り）
- **優先度**: P0
- **見積もり**: M
- **依存関係**: TKT-002, TKT-003
- **概要**:
  - `GET /api/v1/commands`
  - `GET /api/v1/commands/{cmdId}`
  - status・project・limitフィルタ対応
- **完了条件（DoD）**:
  - cmd一覧のページングと詳細表示が可能

### TKT-006: タスク/レポートAPI（読み取り）
- **優先度**: P0
- **見積もり**: M
- **依存関係**: TKT-002, TKT-003
- **概要**:
  - `GET /api/v1/tasks`, `GET /api/v1/tasks/{agentId}`
  - `GET /api/v1/reports`, `GET /api/v1/reports/{agentId}`
- **完了条件（DoD）**:
  - エージェント別の状況がUIで一覧表示できる

### TKT-007: ホームダッシュボード画面（スマホ優先）
- **優先度**: P0
- **見積もり**: M
- **依存関係**: TKT-004
- **概要**:
  - KPIカード、要対応リスト、最新レポートを表示
  - スマホ表示で1カラム構成
- **完了条件（DoD）**:
  - iPhone/Android幅で崩れず閲覧可能

### TKT-008: コマンド一覧/詳細画面
- **優先度**: P0
- **見積もり**: M
- **依存関係**: TKT-005
- **概要**:
  - cmd一覧、詳細モーダル、基本フィルタを実装
- **完了条件（DoD）**:
  - 「進行中のみ」「要対応のみ」などの絞り込みができる

### TKT-009: タスク/レポート閲覧画面
- **優先度**: P0
- **見積もり**: M
- **依存関係**: TKT-006
- **概要**:
  - エージェント別タブ、最新順ソート、詳細表示
- **完了条件（DoD）**:
  - 非エンジニアでも「誰が何をしているか」を追える

### TKT-010: エラーハンドリング＆空状態UI
- **優先度**: P0
- **見積もり**: S
- **依存関係**: TKT-007, TKT-008, TKT-009
- **概要**:
  - API障害時メッセージ
  - データなし時の空表示テンプレート
- **完了条件（DoD）**:
  - 真っ白画面が発生しない

---

## P1（次優先）: 運用品質と導入しやすさを高める

### TKT-011: 簡易認証（Owner/Viewer）
- **優先度**: P1
- **見積もり**: M
- **依存関係**: TKT-001
- **概要**:
  - 最低限のログイン導線
  - 閲覧専用ロールを分離
- **完了条件（DoD）**:
  - ログインなしアクセスを制限できる

### TKT-012: 監査ログ基盤（閲覧操作）
- **優先度**: P1
- **見積もり**: S
- **依存関係**: TKT-004〜TKT-009
- **概要**:
  - APIアクセスログを保存
  - 後続の書き込み操作ログへ拡張可能な構造
- **完了条件（DoD）**:
  - 誰がいつ何を見たか追跡できる

### TKT-013: WSL + Windows向け運用ガイド
- **優先度**: P1
- **見積もり**: S
- **依存関係**: TKT-001〜TKT-010
- **概要**:
  - 「起動・停止・トラブル対応」を3ステップ化
  - 非エンジニア向けスクリーンショット付き手順書
- **完了条件（DoD）**:
  - ターミナルに不慣れでも運用開始できる

### TKT-014: 基本テスト整備
- **優先度**: P1
- **見積もり**: M
- **依存関係**: TKT-004〜TKT-010
- **概要**:
  - Backend: APIユニットテスト
  - Frontend: 主要画面の表示テスト
- **完了条件（DoD）**:
  - CIで最低限の回帰検知ができる

---

## P2（拡張）: 指示・レビューの書き込み機能

### TKT-015: 指示作成API（POST、バリデーション付き）
- **優先度**: P2
- **見積もり**: L
- **依存関係**: TKT-003, TKT-012
- **概要**:
  - UI入力を `shogun_to_karo.yaml` 形式へ変換
  - 必須項目チェック（id, purpose, acceptance_criteria, status等）
- **完了条件（DoD）**:
  - フォームから安全に指示作成できる

### TKT-016: レビュー承認/差戻しAPI（POST）
- **優先度**: P2
- **見積もり**: M
- **依存関係**: TKT-012, TKT-015
- **概要**:
  - 承認・差戻し・コメントを保存
  - 監査ログに必ず残す
- **完了条件（DoD）**:
  - レビュー履歴がUI上で追跡できる

### TKT-017: 指示作成画面（自然文→プレビュー→送信）
- **優先度**: P2
- **見積もり**: M
- **依存関係**: TKT-015
- **概要**:
  - 自然文入力
  - 送信前プレビュー（構造化内容確認）
- **完了条件（DoD）**:
  - 非エンジニアが誤送信しにくいUIになる

### TKT-018: レビュー画面（承認/差戻し操作）
- **優先度**: P2
- **見積もり**: M
- **依存関係**: TKT-016
- **概要**:
  - レポート詳細上で承認/差戻し
  - 差戻し時はコメント必須
- **完了条件（DoD）**:
  - レビュー運用がターミナル不要で完結する

---

## 2. 実装順（推奨ロードマップ）

### Sprint 1（1〜2週間）
- TKT-001〜TKT-006
- 目標: APIで可視化データが取れる

### Sprint 2（1週間）
- TKT-007〜TKT-010
- 目標: スマホで閲覧できるMVP UI完成

### Sprint 3（1週間）
- TKT-011〜TKT-014
- 目標: 最低限の認証・運用品質確保

### Sprint 4以降（1〜2週間）
- TKT-015〜TKT-018
- 目標: 指示/レビューをUIで完結

---

## 3. 依存関係マップ（簡易）

- TKT-001 → TKT-002,003,011
- TKT-002 + TKT-003 → TKT-004,005,006
- TKT-004 → TKT-007
- TKT-005 → TKT-008
- TKT-006 → TKT-009
- TKT-007,008,009 → TKT-010
- TKT-004〜009 → TKT-012,014
- TKT-001〜010 → TKT-013
- TKT-003,012 → TKT-015
- TKT-012,015 → TKT-016
- TKT-015 → TKT-017
- TKT-016 → TKT-018

---

## 4. 実務メモ（運用上の注意）

- いきなり書き込み機能を入れず、**まず閲覧MVPで運用理解を合わせる**。
- スマホ主利用なら、テーブル中心よりカードUI中心が見やすい。
- 監査ログは早めに入れるほど、後のトラブル調査コストが下がる。
- 将来的にGitHub無料アカウントを使う場合、ActionsでAPIテスト自動化を先に整えると安全。
